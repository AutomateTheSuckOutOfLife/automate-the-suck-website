---
import Layout from './Layout.astro';
import SocialFollow from '../components/SocialFollow.astro';
import { format } from 'date-fns';

interface Frontmatter {
  title: string;
  publishDate?: Date;
  description?: string;
  tags?: string[];
  draft?: boolean;
  author?: string;
  category?: string;
  headerImage?: string;
  headerImageAlt?: string;
}

const { frontmatter } = Astro.props;
const { title, publishDate, description, tags, draft, author, category, headerImage, headerImageAlt } = frontmatter as Frontmatter;

const formattedDate = publishDate ? format(publishDate, 'MMMM d, yyyy') : '';
---

<Layout title={`${title} | Automate The Suck`}>
  <main class="max-w-4xl mx-auto px-4 py-16">
    <div class="mb-8">
      <a href="/projects" class="inline-flex items-center text-link-base hover:text-link-hover dark:text-link-dark-base dark:hover:text-link-dark-hover transition-colors">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
        </svg>
        Back to Projects
      </a>
    </div>
    
    <article class="max-w-3xl mx-auto">
      {draft && (
        <div class="mb-8 p-4 bg-button-light border-l-4 border-primary rounded dark:bg-dark-primary dark:border-link-dark-base" role="alert">
          <p class="text-lg font-medium">üìù Work in Progress</p>
          <p class="text-accent dark:text-dark-text">This is a draft project. Details and content are subject to change.</p>
        </div>
      )}
      
      <header class="mb-12 space-y-6">
        <div class="space-y-2">
          {publishDate && (
            <time datetime={publishDate.toISOString()} 
                  class="text-sm text-primary dark:text-link-dark-base font-mono">
              {formattedDate}
            </time>
          )}
          <h1 class="text-4xl md:text-5xl font-serif font-bold text-primary dark:text-link-dark-base">{title}</h1>
        </div>
        
        {description && (
          <p class="text-xl text-accent dark:text-dark-text font-light">
            {description}
          </p>
        )}
        
        <div class="flex flex-wrap items-center gap-4">
          {author && (
            <span class="text-sm text-accent/70 dark:text-dark-text/70">
              By {author}
            </span>
          )}
          
          {category && (
            <span class="inline-block bg-button-hover dark:bg-dark-primary text-primary dark:text-link-dark-base text-sm px-3 py-1 rounded-full">
              {category}
            </span>
          )}
        </div>
        
        {tags && tags.length > 0 && (
          <div class="flex flex-wrap gap-2">
            {tags.map((tag: string) => (
              <span class="text-sm text-accent/60 dark:text-dark-text/60">
                #{tag}
              </span>
            ))}
          </div>
        )}
      </header>

      {headerImage && (
        <div class="mb-8 rounded-lg overflow-hidden">
          <img 
            src={headerImage}
            alt={headerImageAlt || `Header image for ${title}`}
            class="w-full h-auto object-cover"
          />
        </div>
      )}

      <div class="prose prose-lg max-w-none text-accent dark:text-dark-text 
                  prose-headings:text-primary dark:prose-headings:text-link-dark-base 
                  prose-a:text-link-base dark:prose-a:text-link-dark-base 
                  hover:prose-a:text-link-hover dark:hover:prose-a:text-link-dark-hover
                  prose-img:rounded-lg prose-img:shadow-md prose-img:w-full prose-img:h-auto
                  prose-strong:text-primary dark:prose-strong:text-link-dark-base
                  prose-code:text-primary dark:prose-code:text-link-dark-base
                  prose-blockquote:border-primary dark:prose-blockquote:border-link-dark-base
                  prose-hr:border-primary/20 dark:prose-hr:border-link-dark-base/20">
        <slot />
      </div>
      
      <div class="mt-16">
        <SocialFollow />
      </div>
    </article>
  </main>
</Layout> 